var data,lio;let tr,tr_o,st_o,gn=null,lc_=null,trFlag=0;function wr(){if(1015<window.innerWidth){var c=(window.innerWidth-620)/2;menu.style.left=c-200+'px',menu.style.display='block',menu.style.transform='scale(1)',pan.style.left=c+'px',pan.style.display='block',trop.style.left=c+64+'px'}else menu.style.left='0px',menu.style.display='block',menu.style.transform='scale(0.7)',pan.style.left='200px',pan.style.display='block',trop.style.left='200px';var h=window.innerWidth-310;0<h?(h/=2,box_t.style.left=h+'px',box_t.style.display='block'):(box_t.style.left='0px',box_t.style.display='block')}function mCl(c){if(0===c.button){let h=c.target.id;if('m5'===h)chrome.tabs.create({url:'https://addons.opera.com/search/?type=extensions&developer=vux777',active:!0});else{con.scrollTop=0;let n=c.target,p=menu.children,q=p.length,s=pan.children,t=s.length;for(;q--;)p[q].className='mBtn',p[q].getElementsByClassName('m_img')[0].style.filter='invert(0) brightness(1)';for(;t--;)s[t].style.display='none';n.className='mBtn mBtnA','m6'!==h&&(n.getElementsByClassName('m_img')[0].style.filter='invert(1) brightness(2)'),document.getElementById(c.target.dataset.r).style.display='block','m7'===h?_getTr():(trFlag&&(trFlag=0,trop.className+=' topItem_off',setTimeout(()=>{trop.className='tropC',trop.style.display='none'},500)),'m8'===h&&_st())}}}const _getTr=()=>{trop2.className='trBtn_off',trop1.className='trBtn_off',trFlag=1,tr_o.innerHTML='',chrome.storage.local.get('trash',c=>{if(tr=c.trash,tr.length){trop1.className='trBtn';let h=[],n={};for(let q,p=tr.length-1;0<=p;p--)q=tr[p].u,n[q]||(n[q]=1,h[h.length]=tr[p]);h.reverse();for(let p=h.length-1;0<=p;p--)_aN(h[p])}else _trEmpty();trop.style.display='flex'})},_st=()=>{chrome.storage.local.get(['s_','data'],c=>{let h=c.s_||[];table.innerHTML='';let n=new Date,p=new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime(),q=new Date(n.getFullYear(),n.getMonth(),n.getDate()-7).getTime(),s=new Date(n.getFullYear(),n.getMonth(),n.getDate()-15).getTime(),t=new Date(n.getFullYear(),n.getMonth(),n.getDate()-30).getTime(),u=new Date(n.getFullYear(),n.getMonth(),n.getDate()-60).getTime(),v=new Date(n.getFullYear(),n.getMonth(),n.getDate()-90).getTime(),y=['','set_w3','set_w4','set_w5','set_w6','set_w7'],A=[0,0,0,0,0,0],B=[0,q,s,t,u,v];for(let C=h.length-1;0<=C;C--)h[C].v<q&&(A[1]+=1),h[C].v<s&&(A[2]+=1),h[C].v<t&&(A[3]+=1),h[C].v<u&&(A[4]+=1),h[C].v<v&&(A[5]+=1);bn.innerHTML='<b>'+h.length+'</b>&nbsp;&nbsp;  '+chrome.i18n.getMessage('set_w1');for(let C=0;6>C;C++){let D=y[C],E=document.createElement('div');E.className='tbWide',table.appendChild(E);let F=document.createElement('div');F.className='tbCell',E.appendChild(F);let G=document.createElement('div');if(G.className='tbCell',E.appendChild(G),0===C?(E.className='tbWide_0',F.textContent=chrome.i18n.getMessage('set_w2'),G.textContent=chrome.i18n.getMessage('set_w8')):(E.x=C,F.textContent=chrome.i18n.getMessage(y[C]),G.textContent=A[C]),A[C]){let H=document.createElement('div');H.className='tbBtn',H.title=chrome.i18n.getMessage('set_trStats')+'\n'+chrome.i18n.getMessage(y[C]),E.appendChild(H),H.addEventListener('click',function(I){if(0===I.button){let J=B[this.parentNode.x];_tbCl(J)}})}}})},_tbCl=c=>{chrome.storage.local.get('s_',h=>{let n=h.s_||[];for(let p=n.length-1;0<=p;p--)if(n[p].v<c){let q=n.splice(p+1);chrome.runtime.sendMessage({delVis:q,d_v:n});break}})},_aN=c=>{let h=document.createElement('div');h.className='b1',h.a=0,h.u=c.u,h.t=c.t,tr_o.appendChild(h);let n=document.createElement('img');n.className='b2',n.setAttribute('data-src',c.i),n.src='img/ph.png',h.appendChild(n);let p=document.createElement('img');p.className='imgPrv_ico',p.setAttribute('style','position: absolute;display: none;width: 24px;height: 24px;left: 83px;top:53px;z-index: 100;'),h.appendChild(p);let q=document.createElement('div');q.className='b3',q.textContent=c.t,h.appendChild(q),h.addEventListener('mousedown',s=>{s.stopPropagation(),s.preventDefault()}),lio.observe(n)},_bCl=c=>{if(0===c.button){let h=c.target;if('b1'===h.className){if(gn=document.getElementsByClassName('b1'),xa=h.a,c.ctrlKey)xa?(h.style.backgroundColor='',h.a=0):(h.style.backgroundColor='#7CACD6',h.a=1);else if(!c.shiftKey){let n=0;for(let p=gn.length-1;0<=p;p--)gn[p].a&&gn[p]!==h&&(n=1),gn[p].style.backgroundColor='',gn[p].a=0;xa?n?(h.style.backgroundColor='#7CACD6',h.a=1):h===lc_&&(h.style.backgroundColor='#7CACD6',h.a=1):(h.style.backgroundColor='#7CACD6',h.a=1)}else if(lc_&&h!==lc_){let n=h.getBoundingClientRect().top,p=lc_.getBoundingClientRect().top,q=n,s=p;n>p&&(q=p,s=n);for(let u,t=gn.length-1;0<=t;t--)u=gn[t].getBoundingClientRect().top,u>=q&&u<=s?(gn[t].style.backgroundColor='#7CACD6',gn[t].a=1):(gn[t].style.backgroundColor='',gn[t].a=0)}lc_=h,_checkSel()}gn=null}},_checkSel=()=>{let c=1;for(let h=gn.length-1;0<=h;h--)if(gn[h].a){c=0;break}trop2.className=c?'trBtn_off':'trBtn'},LMCl=c=>{'o_btn'===c.target.id&&chrome.tabs.create({url:'https://addons.opera.com/extensions/details/v7-stash/',active:!0})},_cs=()=>{0<con.scrollTop?(podloga.style.boxShadow='0 0 10px 3px rgba(0,0,0,0.4)',podloga.style.borderBottom='4px solid #8494A5'):(podloga.style.boxShadow='',podloga.style.borderBottom='')},_tropCL=c=>{if(0===c.button){let h=c.target;if('trop1'===h.id&&'trBtn'===h.className)trop1.className='trBtn_off',trop2.className='trBtn_off',tr=[],chrome.storage.local.set({trash:[]}),tr_o.innerHTML='',_trEmpty();else if('trop2'===h.id&&'trBtn'===h.className){trop2.className='trBtn_off';let n={},p=[];gn=document.getElementsByClassName('b1');for(let q=gn.length-1;0<=q;q--)gn[q].a&&(n[gn[q].u]=1,tr_o.removeChild(gn[q]));for(let q=tr.length-1;0<=q;q--)n[tr[q].u]&&(p[p.length]=tr[q],tr.splice(q,1));chrome.storage.local.get('s_',q=>{let s=q.s_,t=[],u=[],v={};t=s.concat(p);for(let B,y=0,A=t.length;y<A;y++)B=t[y].u,v[B]||(v[B]=1,u[u.length]=t[y]);u.sort(function(y,A){return y.v-A.v}),chrome.runtime.sendMessage({oImp:u}),chrome.storage.local.set({trash:tr})}),tr.length||(trop1.className='trBtn_off',_trEmpty())}}},fic=()=>{let c=document.createElement('input');c.type='file',c.accept='.json',c.id='impId',document.body.appendChild(c),c.addEventListener('change',_impC),c.click()};function _impC(){var c=this.files,h=new FileReader;h.onload=_sST,h.readAsText(c[0])}function _sST(){let c=JSON.parse(this.result);if(c.expDataType&&c.version&&c.data)'V7_Stash'===c.expDataType?chrome.storage.local.get('s_',n=>{let p=n.s_,q=[],s=[],t={};q=p.concat(c.data),q.sort(function(u,v){return u.v-v.v});for(let v,u=q.length-1;0<=u;u--)v=q[u].u,t[v]||(t[v]=1,s.unshift(q[u]));chrome.runtime.sendMessage({oImp:s})}):(alert(chrome.i18n.getMessage('set_alert1')),c=null);else if(Array.isArray(c)){let n=c[0];if(n.expDataType&&'V7 Stash2'===n.expDataType){let p=[];for(let q=c.length-1;2<=q;q--){let s=new Date(c[q].date.split('/').reverse().map(u=>u.trim()).join('-')).getTime(),t={t:c[q].nam,u:c[q].url,i:'../img/def.png',v:s,p:0};p[p.length]=t}chrome.storage.local.get('s_',q=>{let s=q.s_,t=[],u=[],v={};t=s.concat(p);for(let A,y=t.length-1;0<=y;y--)A=t[y].u,v[A]||(v[A]=1,u[u.length]=t[y]);u.sort(function(y,A){return y.v-A.v}),chrome.runtime.sendMessage({oImp:u}),alert(chrome.i18n.getMessage('set_alert2')+' \n'+chrome.i18n.getMessage('set_alert3'))})}c=null}else alert(chrome.i18n.getMessage('set_alert1')),c=null;let h=document.getElementById('impId');h.parentNode.removeChild(h)}function _op(c){if(0===c.button){let h=c.target.className,n=c.target.id,p=0;'boxA boxE'===c.target.className?(c.target.className='boxA boxC',p=1,'op1'===c.target.id?data.op1=1:'op2'===c.target.id?data.op2=1:'op3'===c.target.id?(data.op3=1,chrome.runtime.sendMessage({d_ctx:1,d_true:1})):'op4'===c.target.id?(data.op4=1,chrome.runtime.sendMessage({theme:2})):'op6'===c.target.id?data.op6=1:'op7'===c.target.id&&(data.op7=1)):'boxA boxC'===c.target.className&&(c.target.className='boxA boxE',p=1,'op1'===c.target.id?data.op1=0:'op2'===c.target.id?data.op2=0:'op3'===c.target.id?(data.op3=0,chrome.runtime.sendMessage({d_ctx:1,d_true:0})):'op4'===c.target.id?(data.op4=0,chrome.runtime.sendMessage({theme:1})):'op6'===c.target.id?data.op6=0:'op7'===c.target.id&&(data.op7=0)),p&&chrome.runtime.sendMessage({d_new:data})}}chrome.runtime.onMessage.addListener(c=>{c.trashR?'block'===tr_o.style.display?_mdSim(m7):'block'===st_o.style.display&&_mdSim(m8):c.rf_&&window.location.reload()}),document.addEventListener('DOMContentLoaded',()=>{var c=window.innerWidth,h=c-310;if(1015<c){var n=(c-620)/2;menu.style.left=n-200+'px',menu.style.display='block',pan.style.left=n+'px',pan.style.display='block',trop.style.left=n+64+'px'}else menu.style.left='0px',menu.style.display='block',pan.style.left='200px',pan.style.display='block',trop.style.left='200px';0<h?(h/=2,box_t.style.left=h+'px',box_t.style.display='block'):(box_t.style.left='0px',box_t.style.display='block'),menu.addEventListener('mousedown',mCl),chrome.storage.local.get('data',t=>{data=t.data,data.op1&&(op1.className='boxA boxC'),data.op2&&(op2.className='boxA boxC'),data.op3&&(op3.className='boxA boxC'),data.op4&&(op4.className='boxA boxC'),data.op6&&(op6.className='boxA boxC'),data.op7&&(op7.className='boxA boxC')}),document.documentElement.addEventListener('contextmenu',function(t){t.preventDefault()}),con.addEventListener('scroll',_cs),window.addEventListener('resize',wr),fakeImp.addEventListener('click',fic),opPH.addEventListener('click',_op),exp.addEventListener('click',function(){chrome.runtime.sendMessage({exp:'stash'})});let p=document.querySelectorAll('[data-i18n]');for(let t=p.length-1;0<=t;t--)p[t].textContent=chrome.i18n.getMessage(p[t].getAttribute('data-i18n'));let q=document.getElementsByClassName('versionDate');for(let t=q.length-1;0<=t;t--){let u=+q[t].textContent,v=new Date(u);q[t].textContent=v.toLocaleDateString()}tr_o=document.getElementById('trash'),st_o=document.getElementById('stats'),tr_o.addEventListener('click',_bCl),trop.addEventListener('click',_tropCL),pp_link.addEventListener('click',()=>{chrome.tabs.create({url:'https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=4LFHZT6R4K6CA',active:!0})}),lio=new IntersectionObserver(t=>{t.forEach(v=>{if(v.isIntersecting){let y=v.target;y.onerror=function(){y.src='../img/def.png'},y.onload=function(){if(100>this.naturalWidth){this.src='../img/def.png';let A=this.parentNode.getElementsByClassName('imgPrv_ico')[0];A.src=y.dataset.src,A.style.display='block'}},y.src=y.dataset.src,lio.unobserve(y)}})},{root:con,rootMargin:'300px'});let s=location.href.split('#');s[1]?_mdSim(m2):_mdSim(m1)});const _mdSim=c=>{let h=document.createEvent('MouseEvents');h.initEvent('mousedown',!0,!0),c.dispatchEvent(h)},_trEmpty=()=>{let c=document.createElement('div');c.id='tr_fb',c.innerHTML=chrome.i18n.getMessage('tr_emty_1')+'<br />'+chrome.i18n.getMessage('tr_emty_2'),tr_o.appendChild(c)};