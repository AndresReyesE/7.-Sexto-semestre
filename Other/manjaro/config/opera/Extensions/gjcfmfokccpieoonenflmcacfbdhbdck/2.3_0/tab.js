var s_,data,t_,mj_=['m_1','m_2','m_3','m_4','m_5','m_6','m_7','m_8','m_9','m_10','m_11','m_12'];let today,yesterday,week,monthStart,testId,ctxM_=null,lio,winRes_,wiw,e1,e2,e3;document.addEventListener('DOMContentLoaded',()=>{var g=new Date;today=new Date(g.getFullYear(),g.getMonth(),g.getDate()).getTime(),yesterday=today-8.64e7,week=today-6.048e8,monthStart=new Date(g.getFullYear(),g.getMonth()).getTime(),lio=new IntersectionObserver(q=>{q.forEach(v=>{if(v.isIntersecting){let w=v.target;w.onerror=function(){w.src='../img/def.png'},w.onload=function(){if(100>this.naturalWidth){this.src='../img/def.png';let z=this.parentNode.getElementsByClassName('imgPrv_ico')[0];z.src=w.dataset.src,z.style.display='block'}},w.src=w.dataset.src,lio.unobserve(w)}})},{root:bg,rootMargin:'300px'}),_main(),bg.addEventListener('scroll',scr),document.documentElement.addEventListener('contextmenu',q=>{q.preventDefault()}),d_d.o=0,d_d.addEventListener('blur',_mB),d_d.setAttribute('tabIndex','1'),d_d.addEventListener('click',_dc),t_=document.getElementById('top'),gore.addEventListener('click',_gc);let h=document.querySelectorAll('[data-i18n]');for(let q=h.length-1;0<=q;q--)h[q].textContent=chrome.i18n.getMessage(h[q].getAttribute('data-i18n'));t_.addEventListener('click',_topCl)});const _makeList=(g,h,q,s)=>{let v=document.createElement('div');v.id=g,v.className='vrClass',con.appendChild(v),v.textContent=s?q:chrome.i18n.getMessage(q);let w=document.createElement('div');w.id=h,w.className='LClass',con.appendChild(w)};function _main(){con.innerHTML='',chrome.storage.local.get(['s_','data'],g=>{s_=g.s_||[],data=g.data,wiw=window.innerWidth-200,e1=Math.floor(wiw/260),e2=260*e1,e3=Math.floor((wiw-e2)/2),con.style.width=e2+'px',con.style.left=e3+100+'px',_go(s_),br.textContent=s_.length,br.broj=s_.length})}const _go=g=>{let h={},q=[];for(let w,v=g.length-1;0<=v;v--)if(w=g[v].v,w>today)g[v].par='tdList',h.tdList||(h.tdList=0,q[q.length]='tdList',_makeList('tdNode','tdList','today')),h.tdList+=1;else if(w>yesterday)g[v].par='ydList',h.ydList||(h.ydList=0,q[q.length]='ydList',_makeList('ydNode','ydList','yesterday')),h.ydList+=1;else if(w>week)g[v].par='week',h.week||(h.week=0,q[q.length]='week',_makeList('wNode','week','l7d')),h.week+=1;else if(w>monthStart)g[v].par='mList',h.mList||(h.mList=0,q[q.length]='mList',_makeList('mNode','mList','early_t_m')),h.mList+=1;else{let z=new Date(w),A=z.getFullYear(),B=z.getMonth(),C=B+'_'+A,D=C+'_L',E=chrome.i18n.getMessage(mj_[B])+' '+A;g[v].par=D,h[D]||(h[D]=0,q[q.length]=D,_makeList(C,D,E,1)),h[D]+=1}let s=0;for(let v=0,w=q.length;v<w;v++){let z=q[v],A=document.getElementById(z),B=h[z],C=190*Math.ceil(B/e1);A.style.height=C+'px',A.previousSibling.style.top=s+'px',A.style.top=s+36+'px',A.x=0,A.y=0;s+=C+76}for(let v=g.length-1;0<=v;v--)_addNode(g[v]);con.style.height=s+50+'px'},_addNode=g=>{let h=new URL(g.u).hostname;h.startsWith('www.')&&(h=h.substring(4));let q=document.getElementById(g.par),s=document.createElement('div');s.className='blokNode',s.id=g.v,s.u=g.u,s.p=g.p,s.t=g.t,s.style.top=q.y,s.style.left=q.x,q.appendChild(s);let v=document.createElement('img');v.className='slikaN',v.setAttribute('data-src',g.i),v.src='../img/ph.png',s.appendChild(v);let w=document.createElement('img');w.className='imgPrv_ico',w.setAttribute('style','position: absolute;display: none;width: 24px;height: 24px;left: 210px;top:122px;z-index: 100;'),s.appendChild(w);let z=document.createElement('div');z.className='nazivN',z.textContent=g.t,s.appendChild(z),s.addEventListener('mouseup',_mu),s.addEventListener('mousedown',function(A){A.stopPropagation(),A.preventDefault(),ctxM_&&ctxM_.blur(),this.style.transform='scale(0.97)',this.addEventListener('mouseleave',_ml),testId=this.id}),lio.observe(v),q.x+=260,q.x>=e2&&(q.x=0,q.y+=190)};function _ml(){this.style.transform='scale(1)',this.removeEventListener('mouseleave',_ml)}function _mu(g){if(this.style.transform='scale(1)',this.removeEventListener('mouseleave',_ml),this.id===testId&&('slikaN'===g.target.className||'nazivN'===g.target.className))if(0===g.button)data.op8?data.op2&&g.metaKey?_tabOpen(this.u,!1):data.op1?_tabOpen(this.u,!0):chrome.tabs.update({url:this.u}):data.op2&&g.ctrlKey?_tabOpen(this.u,!1):data.op1?_tabOpen(this.u,!0):chrome.tabs.update({url:this.u});else if(1===g.button)_tabOpen(this.u,!1);else if(2===g.button){ctxM_=document.createElement('div'),ctxM_.className='ctxM',ctxM_.u=this.u,this.style.backgroundColor='#1D6199';let h=document.createElement('div');h.className='ctxN',h.id='cn1',h.textContent=chrome.i18n.getMessage('ont'),ctxM_.appendChild(h);let q=document.createElement('div');q.className='ctxN',q.id='cn2',q.textContent=chrome.i18n.getMessage('del'),ctxM_.appendChild(q);let s=con.clientWidth,v=g.pageX,w=g.pageY,z=window.innerHeight;ctxM_.style.top=w+'px',ctxM_.style.left=v+'px',ctxM_.style.display='block',document.documentElement.appendChild(ctxM_),ctxM_.addEventListener('click',_cp),ctxM_.addEventListener('blur',_cb),ctxM_.setAttribute('tabIndex','1'),ctxM_.focus()}}function _topCl(g){0===g.button&&('srBtn'===g.target.id?_makeSearch():'settings'===g.target.id&&!d_d.o&&(d_d.style.opacity='1',d_d.style.top='62px',d_d.o=1,d_d.focus()))}const _tabOpen=(g,h)=>{data.op6?chrome.tabs.query({currentWindow:!0,active:!0},q=>{chrome.tabs.create({url:g,active:h,index:q[0].index+1})}):chrome.tabs.create({url:g,active:h})};function _makeSearch(){let g=document.createElement('div');g.className='topB',t_.appendChild(g);let h=document.createElement('input');h.type='search',h.placeholder=chrome.i18n.getMessage('sph'),h.className='hsb',g.appendChild(h),h.addEventListener('input',_search),h.addEventListener('keydown',_escSr),h.focus(),g.addEventListener('click',function(q){0===q.button&&q.target===this&&_searchOff(this,h)}),con.innerHTML=''}function _search(){var g=this.value.toLowerCase();if(con.innerHTML='',2<this.value.length){let h=[];for(let v,q=0,s=s_.length;q<s;q++)v=s_[q].u+' '+s_[q].t,v.toLowerCase().includes(g)&&(h[h.length]=s_[q]);_go(h)}}function _escSr(g){27===g.keyCode&&_searchOff(this.parentNode,this)}const _searchOff=(g,h)=>{h.className+=' topItem_off',setTimeout(()=>{g.className+=' topIBg_off'},200),setTimeout(()=>{t_.removeChild(g)},400),con.style.opacity=0,setTimeout(()=>{con.innerHTML='',_go(s_),con.style.opacity=1},300)};function _cp(g){0===g.button&&('cn1'===g.target.id?(_tabOpen(this.u,!1),this.blur()):'cn2'===g.target.id&&(_removeNode(this.u),_spliceSend(this.u),this.blur()))}function _dc(g){0===g.button&&('d_d_02'===g.target.id?_delAll():'d_d_03'===g.target.id?_delVis():'d_d_04'===g.target.id?(con.style.opacity=0,setTimeout(()=>{con.innerHTML='',_showUV()},400)):'d_d_05'===g.target.id?chrome.runtime.sendMessage({exp:1}):'d_d_06'===g.target.id?chrome.runtime.openOptionsPage():'d_d_07'===g.target.id&&chrome.tabs.create({url:'https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=4LFHZT6R4K6CA',active:!0})),d_d.blur()}function _cb(){let g=this.u,h=document.getElementsByClassName('blokNode');this.parentNode.removeChild(this),ctxM_=null;for(let q=h.length-1;0<=q;q--)h[q].u===g&&(h[q].style.backgroundColor='')}const _mB=()=>{d_d.style.opacity=0,setTimeout(()=>{d_d.style.top='-350px',d_d.o=0},300)},_removeNode=g=>{let h=document.getElementById('rf');if(!h){let s,v,w,q=document.getElementsByClassName('blokNode');for(let z=q.length-1;0<=z;z--)if(q[z].u===g){let A=q[z];s=A.parentNode,v=s.previousSibling;s.clientHeight;A.style.width=0,br.broj-=1,br.textContent=br.broj,w=s.children.length;let C=Math.ceil(w/e1),D=Math.ceil((w-1)/e1);if(2>w)v.style.height=0,s.style.height=0,setTimeout(()=>{v.parentNode.removeChild(v),s.parentNode.removeChild(s);let E=document.getElementsByClassName('LClass'),F=0;for(let G=0,H=E.length;G<H;G++)E[G]!==s&&(E[G].previousSibling.style.top=F+'px',E[G].style.top=F+36+'px',F+=E[G].clientHeight+76);con.style.height=F+50+'px'},300);else if(C!==D){setTimeout(()=>{s.removeChild(A)},300);let E=190*D;if(s.style.height=E+'px',_pomakUnutarListe(s,g),s.nextSibling){let F=document.getElementsByClassName('LClass'),G=0;for(let H=0,I=F.length;H<I;H++)F[H]===s?G+=E+76:(F[H].previousSibling.style.top=G+'px',F[H].style.top=G+36+'px',G+=F[H].clientHeight+76);con.style.height=G+50+'px'}else con.style.height=con.clientHeight-190+'px'}else setTimeout(()=>{s.removeChild(A)},300),_pomakUnutarListe(s,g);break}}},_spliceSend=g=>{let h;for(let q=s_.length-1;0<=q;q--)s_[q].u===g&&(h=s_.splice(q,1));chrome.runtime.sendMessage({delUrl:g,s:s_,d_n:h})},_delAll=()=>{let g=confirm(chrome.i18n.getMessage('confirm1'));!0==g&&(s_=[],con.innerHTML='',br.textContent=0,br.broj=0,chrome.runtime.sendMessage({delAll:1}))},_delVis=()=>{let g=confirm(chrome.i18n.getMessage('confirm2'));if(!0==g){let h=[];for(let q=s_.length-1;0<=q;q--)s_[q].p&&(h.unshift(s_[q]),s_.splice(q,1),f=1);h.length&&(con.style.opacity=0,setTimeout(()=>{con.innerHTML='',_go(s_)},300),br.textContent=s_.length,br.broj=s_.length,setTimeout(()=>{con.style.opacity=1},500),chrome.runtime.sendMessage({delVis:s_,d_v:h}))}},_pomakUnutarListe=(g,h)=>{let q=g.getElementsByClassName('blokNode'),s=0,v=0;for(let w=0,z=q.length;w<z;w++)q[w].u!==h&&(q[w].style.top=v+'px',q[w].style.left=s+'px',s+=260,s>=e2&&(s=0,v+=190))};chrome.runtime.onMessage.addListener(g=>{if(g.ukloni)s_=g.s,_removeNode(g.ukloni);else if(g.dodaj)_ref();else if(g.vis)_visitNode(g.vis),s_=g.s;else if(g.oImp||g.delVis)_ref();else if(g.imgDrop){s_=g.imgDrop;let h=document.getElementsByClassName('blokNode'),q=g.url,s=g.img_;for(let v=h.length-1;0<=v;v--)if(h[v].u===q){let w=h[v].getElementsByClassName('slikaN')[0];getI.onerror=function(){getI.src='../img/def.png'},getI.src=s,w.setAttribute('data-src',s)}}else g.delUrl?(s_=g.s,_removeNode(g.delUrl)):g.delAll?(s_=[],con.innerHTML='',br.textContent=0,br.broj=0):g.d_new?data=g.d_new:g.rf_&&window.location.reload()});const _showUV=()=>{let g=[];for(let s=0,v=s_.length;s<v;s++)s_[s].p||(g[g.length]=s_[s]);let h=document.createElement('div');h.className='topB',t_.appendChild(h);let q=document.createElement('div');q.className='topBack',q.textContent=chrome.i18n.getMessage('back'),h.appendChild(q),_go(g),con.style.opacity=1,h.addEventListener('click',s=>{0===s.button&&(con.style.opacity=0,con.innerHTML='',q.className+=' topItem_off',setTimeout(()=>{h.className+=' topIBg_off'},200),setTimeout(()=>{t_.removeChild(h)},400),setTimeout(()=>{_go(s_),con.style.opacity=1},400))})},_visitNode=g=>{let h=document.getElementsByClassName('blokNode');for(let q=h.length-1;0<=q;q--)h[q].u===g&&(h[q].p=1)},_ref=()=>{let g=document.getElementById('rf');if(!g){let h=document.createElement('div');h.setAttribute('style','position:fixed;width:100%;height:100%;top:0;left:0;-webkit-user-select:none;z-index:2147483647;overflow:hidden;background-color:rgba(0,0,0,0.8)'),document.body.appendChild(h),h.addEventListener('click',()=>{window.location.reload()});let q=document.createElement('div');q.id='rf',h.appendChild(q),q.textContent=chrome.i18n.getMessage('ctf')}};function scr(){ctxM_&&ctxM_.blur(),20<bg.scrollTop?(top_bg.style.boxShadow='0 7px 10px 5px rgba(0,0,0,0.5)',gore.style.display='block'):(top_bg.style.boxShadow='',gore.style.display='none')}const _winRes=()=>{ctxM_&&ctxM_.blur(),d_d.o&&d_d.blur(),wiw=window.innerWidth-200,e1=Math.floor(wiw/260),e2=260*e1,e3=Math.floor((wiw-e2)/2),con.style.width=e2+'px',con.style.left=e3+100+'px';let g=document.getElementsByClassName('LClass'),h=0;for(let q=0,s=g.length;q<s;q++){let v=g[q],w=v.children,z=w.length,A=Math.ceil(z/e1),B=v.previousSibling;B.style.top=h+'px',v.style.top=h+36+'px',v.style.height=190*A+'px';let C=0,D=0;h+=190*A+76;for(let F=0;F<z;F++)w[F].style.top=D,w[F].style.left=C,C+=260,C>=e2&&(C=0,D+=190)}con.style.height=h+50+'px'};function _gc(){0!==bg.scrollY&&bg.scrollTo(0,0)}window.addEventListener('resize',()=>{clearTimeout(winRes_),winRes_=setTimeout(_winRes,200)});